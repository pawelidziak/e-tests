<section *ngIf="test" id="testLearnSection">

  <div class="test-learn-exercise container">
    <app-test-config *ngIf="!areSettingsSet"
                     (startTestEvent)="saveSettingsAndStartTest($event)">
    </app-test-config>


    <div *ngIf="areSettingsSet">
      <app-exercise *ngIf="!isTestEnd"
                    [exerciseWithOccurrences]="currentExercise"
                    [repetitionExerciseNumber]="test.settings.repetitionNumber"
                    [checkClicked]="isCheckClicked"
                    (answerClicked)="handleSelectedAnswer($event)"
                    style="overflow-x: hidden">
      </app-exercise>

      <div *ngIf="isTestEnd" class="test-end">
        <mat-icon id="done" aria-label="Done icon">done</mat-icon>
        <span>Congratulations, you've mastered all the exercises!</span>
        <button mat-raised-button color="accent" (click)="resetTest()">RESET TEST</button>
      </div>

    </div>

  </div>


  <mat-toolbar class="test-learn-footer" *ngIf="areSettingsSet">

    <div class="test-learn-footer_inner container">
      <div class="flex-2">

        <div class="footer-flex-item ">
          <span class="flex-1" *ngIf="!isSmallScreen">Viewed:</span>
          <mat-progress-bar
            class="flex-4"
            color="accent"
            mode="determinate"
            [value]="countReviewedRatio()">
          </mat-progress-bar>
        </div>

        <div class="footer-flex-item">
        <span class="flex-1" *ngIf="!isSmallScreen">Mastered: </span>
          <mat-progress-bar
            class="flex-4"
            color="accent"
            mode="determinate"
            [value]="countMasteredRatio()">
          </mat-progress-bar>
        </div>

        <div style="display: flex; justify-content: space-between">
          <span>All: {{origTestExercises.length}}</span>
          <span>Repeats: {{currentExercise.occurrences}}</span>
        </div>

      </div>


      <button mat-icon-button class="flex-1">
        <mat-icon>more_vert</mat-icon>
      </button>

      <div class="gym flex-1">
        <!--<button mat-stroked-button (click)="checkAnswers()">-->
          <!--<span *ngIf="!isCheckClicked">check</span>-->
          <!--<span *ngIf="isCheckClicked">next</span>-->
        <!--</button>-->
        <button mat-stroked-button
                *ngIf="!isCheckClicked"
                (click)="isCheckClicked = true">
          check
        </button>
        <button mat-stroked-button
                *ngIf="isCheckClicked"
                (click)="nextExercise()">
          next
        </button>
      </div>

    </div>


  </mat-toolbar>


</section>
